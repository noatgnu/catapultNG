<div class="container-fluid pt-5 overflow-auto d-flex flex-row gap-2 h-100">
  <div class="d-flex flex-row gap-2" style="width: 50%; height: 40vh">
    <div class="d-flex flex-row flex-wrap gap-2">
      <div>
        <div class="card">
          <div class="card-header">
            <h5 class="card-title">Work Statistics</h5>
          </div>
          <div class="card-body">
            <p class="card-text">
              Experiments: {{n_experiments}}
            </p>
            <p class="card-text">
              Analyses: {{n_analyses}}
            </p>
            <p class="card-text">
              Tasks: {{n_tasks}}
            </p>
          </div>
        </div>
      </div>
      <div class="card">
        <div class="card-header">
          <h5 class="card-title">
            Workers
          </h5>
        </div>
        <div class="card-body">
          <table class="table">
            <thead>
            <tr>
              <th scope="col">Worker</th>
              <th scope="col">Status</th>
              <th scope="col">OS</th>
              <th scope="col">Current Tasks</th>
            </tr>
            </thead>
            <tbody>
              @for (worker of workerQuery?.results; track worker) {
                <tr (click)="clickWorkerRow(worker.worker_hostname)"
                    [ngClass]="{'table-primary': worker.worker_hostname === selectedWorker}"
                >
                  <td>{{worker.worker_hostname}}</td>
                  <td>{{worker.worker_status}}</td>
                  <td>{{worker.worker_os}}</td>
                  <td>
                    <ul>
                      @for (task of worker.current_tasks; track task) {
                        <li>
                          {{task.task_id}}<br>
                          {{task.task_name}}
                        </li>
                      }
                    </ul>
                  </td>
                </tr>
              }
            </tbody>
          </table>
        </div>
      </div>
      <div class="d-flex flex-column">

      </div>
    </div>


  </div>
  <div class="flex-grow-1">
    <div class="card">
      <div class="card-header">
        @if (selectedWorker) {
          <h5 class="card-title">
            Working task details for <span class="text-primary">{{selectedWorker}}</span>
          </h5>
        } @else {
          <h5 class="card-title">
            Select a worker to follow its tasks log output
          </h5>
        }


      </div>
      <div class="card-body" style="overflow-y:auto; height: 84vh" #logContainer>
        <div
          class="d-flex flex-column justify-content-between"
        >
          @for (l of logMessages; track l) {
            <p>
              [{{l.timestamp | date:'short'}}] {{l.hostname}}: {{l.log}}
            </p>
          }
        </div>
      </div>
    </div>
  </div>

</div>

